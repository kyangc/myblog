title: 5# Longest Palindromic Substring
date: 2015-01-05 21:30:00
categories: ç®—æ³•
tags: [String,å›æ–‡,ç®—æ³•]
description: å¼±é¸¡è¿›åŸçºªå®
---

> å¼±é¸¡è¿›åŸçºªå®ã€‚

<!--more-->

å¼±ğŸ”å°±æ˜¯è¿™æ ·ï¼Œæ€»æ˜¯è§‰å¾—ä»€ä¹ˆéƒ½å¾ˆç‰›é€¼æƒ³è®°å½•ä¸‹æ¥ï¼Œæ€»æ˜¯è§‰å¾—è‡ªå·±lowå¼±ï¼Œå¯¹ï¼Œæˆ‘å°±æ˜¯ä¸ªå¼±ğŸ”ï¼Œä»Šå¤©åˆæ¥æŠŠå¤§ç¥å±Œç‚¸å¤©çš„ä¸œè¥¿å†™ä¸€å†™ï¼Œå…å¾—å¿˜äº†ï¼Œå—¯ã€‚

é¢˜å‘¢ï¼Œå¾ˆç®€å•ï¼Œ[#5 Longest Palindromic Substring][1]ï¼Œç®€å•è®²å°±æ˜¯æ±‚ä¸€ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å›æ–‡å­å­—ç¬¦ä¸²ã€‚

æˆ‘çš„æ€è·¯æ˜¯æœç´¢ï¼Œå¯¹äºå­—ç¬¦ä¸²ä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦ï¼Œè€ƒå¯Ÿå…¶ä½œä¸ºå›æ–‡å­ä¸²ä¸­å¿ƒæ—¶å¯¹åº”çš„å›æ–‡å­ä¸²é•¿åº¦ï¼Œéå†ç»“æŸï¼Œå¾—åˆ°æœ€é•¿çš„å›æ–‡å­ä¸²ã€‚åœ¨è€ƒå¯Ÿå›æ–‡å­ä¸²çš„æ—¶å€™ï¼Œéœ€è¦å¯¹äºå…¶å›æ–‡å­ä¸²æ˜¯å¶æ•°é•¿åº¦è¿˜æ˜¯å¥‡æ•°é•¿åº¦è¿›è¡ŒåŒºåˆ«è€ƒå¯Ÿã€‚

æ€è·¯å¾ˆç®€å•ï¼Œå®ç°èµ·æ¥ä¹Ÿä¸å¤æ‚ï¼Œæ•´ä¸ªå¤æ‚åº¦æ˜¯O(N^2)ï¼Œç¡®å®ä¹ŸACäº†ï¼Œä½†æ˜¯æˆ‘åœ¨åæ¥ä¸Šç½‘æ‰¾è§£æ³•çš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€ç§O(N)çš„æ–¹æ³•ï¼Œå½“æ—¶å°±æƒŠå‘†äº†ï¼Œèµ¶ç´§å¥½å¥½åœ°çœ‹äº†ä¸€ä¸‹ï¼Œè¿™ç¯‡åšå®¢çš„ä¸»è¦ç›®çš„ä¹Ÿå°±æ˜¯è®°å½•è¿™ä¸ªç®—æ³•ï¼š

> Manacher's ALGORITHM: O(n)æ—¶é—´æ±‚å­—ç¬¦ä¸²çš„æœ€é•¿å›æ–‡å­ä¸²

è¯¥ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æœ‰ä¸¤ç‚¹ï¼Œä¸€æ˜¯å…¶å¯¹å¾…æ±‚å­—ç¬¦ä¸²è¿›è¡Œçš„é¢„å¤„ç†ï¼Œä½¿å¤„ç†è¿‡ç¨‹æ— éœ€å¯¹å¥‡å¶æ€§åšå‡ºè€ƒé‡ï¼›äºŒæ˜¯å…¶åˆ©ç”¨ä¸€ä¸ªå¾ˆå·§å¦™çš„ç»“è®ºï¼Œä¸æ–­åœ°é‡ç”¨å·²æœ‰çš„ç»“æœï¼Œè¾¾åˆ°ç®€åŒ–è¿ç®—é‡çš„ä½œç”¨ã€‚

ä¸‹é¢å°±å…·ä½“æ¥è¯´ä¸‹è¿™ä¸ªç®—æ³•æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼ˆå¤§éƒ¨åˆ†[æ¥è‡ªè¿™é‡Œ][2]ï¼‰ï¼š

é¦–å…ˆå¯¹å­—ç¬¦ä¸²è¿›è¡Œé¢„å¤„ç†ï¼Œç”¨ç‰¹æ®Šå­—ç¬¦å°†å…¶å¡«å……è‡³å¶æ•°ä¸ªå­—ç¬¦æ•°ï¼Œä¾‹å¦‚â€œ123â€å¡«å……è‡³â€œ$#1#2#3#\*â€ï¼Œé¦–å°¾é€‰æ‹©ç‰¹æ®Šå­—ç¬¦ä»¥æ ‡ç¤ºå¼€å§‹ç»“æŸï¼ˆæˆ–è€…åˆ«çš„æ–¹æ³•ä¹Ÿè¡Œï¼‰ã€‚

ç„¶åç”¨ä¸€ä¸ªæ•°ç»„P[i]æ¥è®°å½•ä»¥å­—ç¬¦S[i]ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²å‘å·¦/å³æ‰©å¼ çš„é•¿åº¦ï¼ˆåŒ…æ‹¬S[i]ï¼Œä¹Ÿå°±æ˜¯æŠŠè¯¥å›æ–‡ä¸²â€œå¯¹æŠ˜â€ä»¥åçš„é•¿åº¦ï¼‰ã€‚å¦‚ï¼š

    S  #1#2#2#1#2#3#2#1#
    P  12125214121612121

æ˜¾è§çš„ï¼ŒP[i]-1çš„æœ€å¤§å€¼å°±æ˜¯æˆ‘ä»¬è¦æ±‚çš„æœ€é•¿å›æ–‡å­ä¸²çš„é•¿åº¦ã€‚

é‚£ä¹ˆï¼Œ**å¦‚ä½•è®¡ç®—P[i]ï¼Ÿ**

é¦–å…ˆæˆ‘ä»¬éœ€è¦å…ˆè¯´æ˜ä¸€ä¸ªå…³é”®çš„ä¸ç­‰å¼ï¼š

    P[i] >= MIN(P[2*id-i], mx-i)

-   idæ˜¯å½“å‰æœ€é•¿å›æ–‡å­ä¸²çš„ä¸­å¿ƒ
-   mxæ˜¯å½“å‰æœ€é•¿å›æ–‡å­ä¸²çš„æ‰©å¼ å¤§å°
-   iæ˜¯å½“å‰è€ƒå¯Ÿçš„å­—ç¬¦ä½ç½®
-   j=2\*id-iæ˜¯iç›¸å¯¹äºidå¯¹ç§°çš„ç‚¹

é‚£ä¹ˆè¿™ä¸ªä¸ç­‰å¼çš„å«ä¹‰å°±æ˜¯ï¼Œ**P[i]æˆ–è€…ç­‰äºP[j]ï¼Œæˆ–è€…å¤§äºæˆ–ç­‰äºmx-i**ã€‚

ä¸ºäº†åŠ æ·±ç†è§£ï¼Œç”»ä¸ªå›¾å‡ºæ¥å°±å¾ˆç›´è§‚äº†ï¼š

![P[j]åœ¨æœ€é•¿å­ä¸²å†…][3]

å½“å‰æœ€é•¿å­ä¸²å†…ï¼Œå…³äºä¸­ç‚¹å¯¹ç§°çš„ä¸¤ç‚¹(j,id,i)ï¼Œå¦‚æœå·²ç»ç»è¿‡çš„ç‚¹jä¸Šï¼ŒP[j]å°äºmx-iï¼Œé‚£ä¹ˆP[i]=P[j]ã€‚

![P[j]åœ¨æœ€é•¿å­ä¸²å¤–][4]

å½“å‰æœ€é•¿å­ä¸²å†…ï¼Œå…³äºä¸­ç‚¹idå¯¹ç§°çš„ä¸¤ç‚¹(j,id,i)ï¼Œå¦‚æœå·²ç»ç»è¿‡çš„ç‚¹jä¸Šï¼ŒP[j]å¤§äºmx-iï¼Œé‚£ä¹ˆP[i]è‡³å°‘ç­‰äºmx-iã€‚

è€Œå¯¹äºmxå°äºç­‰äºi(j)çš„æƒ…å†µï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•åšå‡ºä»»ä½•å‡è®¾ï¼Œåªèƒ½è®¤ä¸ºè¿™ä¸ªæ—¶å€™P[i]=1äº†ã€‚

OKï¼Œåˆ°è¿™é‡Œï¼Œæœ€é‡è¦çš„ä¸‰ç‚¹å·²ç»è§£é‡Šæ¸…æ¥šäº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å†™å‡ºå¦‚ä¸‹çš„è®¡ç®—P[i]çš„ä»£ç äº†ï¼š

    //è¾“å…¥ï¼Œå¹¶å¤„ç†å¾—åˆ°å­—ç¬¦ä¸²s
    int p[1000], mx = 0, id = 0;
    //åˆå§‹åŒ–Pæ•°ç»„
    memset(p, 0, sizeof(p));
    //éå†Så­—ç¬¦æ•°ç»„
    for (i = 1; s[i] != '\0'; i++) {
    	//æ ¸å¿ƒç‚¹ï¼Œp[i]çš„å€¼é€šè¿‡å†å²å€¼è¿›è¡Œåˆå§‹åŒ–ã€‚
        p[i] = mx > i ? min(p[2*id-i], mx-i) : 1;
        //å¯¹p[i]è¿›è¡Œæ›´æ–°
        while (s[i + p[i]] == s[i - p[i]]) p[i]++;
        //å¦‚æœp[i]+içš„èŒƒå›´æ¯”mxæ›´å¤§ï¼Œé‚£ä¹ˆåç»­çš„ç‚¹å°±éœ€è¦åœ¨è¿™ä¸ªæ–°çš„èŒƒå›´å†…è¿›è¡Œè€ƒå¯Ÿäº†ã€‚
        if (i + p[i] > mx) {
            mx = i + p[i];
            id = i;
        }
    }
    //æ‰¾å‡ºp[i]ä¸­æœ€å¤§çš„

OKï¼Œåˆ°æ­¤ä¸ºæ­¢è¿™ä¸ªç®—æ³•å°±è®°å½•çš„å·®ä¸å¤šäº†ï¼Œå…¶å®ä¸»è¦çš„æ€æƒ³è¿˜æ˜¯å¤ç”¨ä¹‹å‰ç®—å‡ºæ¥çš„ç»“æœï¼Œè¾¾åˆ°ç®€åŒ–è¿ç®—çš„ç›®çš„ï¼Œè¿™ä¸ªç®—æ³•åœ¨whileå¾ªç¯ä¸Šçœäº†å¾ˆå¤šåŠŸå¤«ã€‚

æ•´ä¸ªå¤æ‚åº¦ä¸å¤ªå¥½ç®—ï¼Œæ—¢ç„¶ä»–è¯´æ˜¯O(N)é‚£å°±æ˜¯O(N)å§ã€‚å“ˆå“ˆã€‚

[1]: https://oj.leetcode.com/problems/longest-palindromic-substring/

[2]: http://www.felix021.com/blog/read.php?2040

[3]: https://ww1.sinaimg.cn/mw690/825558b1gw1enz2yc6707j20em03k0sw.jpg

[4]: https://ww1.sinaimg.cn/mw690/825558b1gw1enz2ye4ndej20em03k74k.jpg
